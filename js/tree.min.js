class TreeRenderer{constructor(e,t){this.container=document.getElementById(e),this.dataManager=t,this.selectedNodeId="root"}renderTree(){this.container.innerHTML="";var e=this.dataManager.treeData,e=this.createTreeNode(e,!0),e=(e.style.animationDelay="0.1s",this.container.appendChild(e),e.classList.add("expanded"),e.querySelector(".tree-item"));e&&e.classList.add("selected")}createTreeNode(t,e=0,n=0){let d=document.createElement("li");d.className="tree-node",d.style.animationDelay=.1*n+"s";var a=t.children&&0<t.children.length;let r=document.createElement("div"),l=(r.className="tree-item",r.dataset.id=t.id,"link"===t.type&&(r.className+=" tree-link-item",r.addEventListener("click",e=>{e.stopPropagation(),window.open(t.url,"_blank")})),document.createElement("span"));l.className="toggle",a&&(l.textContent="▶"),r.appendChild(l);var o,i=document.createElement("span"),i=(i.className="icon","folder"===t.type?i.classList.add("folder-icon"):i.classList.add("link-icon"),r.appendChild(i),document.createElement("span"));if(i.className="name",i.textContent=t.name,"link"===t.type?((o=document.createElement("a")).href=t.url,o.target="_blank",o.className="tree-link",o.appendChild(i),r.appendChild(o)):r.appendChild(i),r.addEventListener("click",e=>{"link"!==t.type&&(e.stopPropagation(),e.target===l?(d.classList.toggle("expanded"),l.textContent=d.classList.contains("expanded")?"▼":"▶","folder"===t.type&&(e=r.querySelector(".folder-icon"))&&e.setAttribute("data-expanded",d.classList.contains("expanded"))):"folder"===t.type&&this.selectNode(t.id))}),d.appendChild(r),a){let a=document.createElement("ul");t.children.forEach((e,t)=>{e=this.createTreeNode(e,!1,n+1);e.style.animationDelay=.1*(n+1)+.05*t+"s",a.appendChild(e)}),d.appendChild(a)}return d}selectNode(e){this.selectedNodeId=e;this.container.querySelectorAll(".tree-item").forEach(e=>{e.classList.remove("selected")});var t=this.container.querySelector(`.tree-item[data-id="${e}"]`),t=(t&&(t.classList.add("selected"),this.expandToNode(e)),new CustomEvent("nodeSelected",{detail:{nodeId:e}}));document.dispatchEvent(t)}expandToNode(e){this.dataManager.getPathToNode(e).forEach(e=>{var t,a=this.container.querySelector(`.tree-item[data-id="${e.id}"]`);a&&(a=a.closest(".tree-node"))&&(a.classList.add("expanded"),(t=a.querySelector(".toggle"))&&""!==t.innerHTML&&(t.textContent="▼"),"folder"===e.type)&&(t=a.querySelector(".folder-icon"))&&t.setAttribute("data-expanded","true")})}expandAll(){this.container.querySelectorAll(".tree-node").forEach(e=>{e.querySelector("ul")&&e.classList.add("expanded")}),this.container.querySelectorAll(".toggle").forEach(e=>{""!==e.innerHTML&&(e.textContent="▼")}),this.container.querySelectorAll(".folder-icon").forEach(e=>{e.setAttribute("data-expanded","true")})}collapseAll(){this.container.querySelectorAll(".tree-node").forEach(e=>{e.classList.remove("expanded")}),this.container.querySelectorAll(".toggle").forEach(e=>{""!==e.innerHTML&&(e.textContent="▶")}),this.container.querySelectorAll(".folder-icon").forEach(e=>{e.setAttribute("data-expanded","false")})}}